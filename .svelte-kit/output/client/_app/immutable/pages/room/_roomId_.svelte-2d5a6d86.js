import{M as de,S as q,i as J,s as Q,t as C,k as V,e as y,h as I,m as M,c as T,g as E,j as A,d as _,a as x,b as R,J as h,N as B,L as H,n as z,O as X,P as ce,x as Z,y as $,z as ee,r as te,p as se,C as ne,Q as me,w as he}from"../../chunks/index-61b7a329.js";import{s as F,r as O,d as j,g as ge,c as _e,o as be}from"../../chunks/database-82165921.js";import{c as S}from"../../chunks/singletons-d1fb5791.js";const ve=()=>{const t=de("__svelte__");return{page:{subscribe:t.page.subscribe},navigating:{subscribe:t.navigating.subscribe},get preloading(){return console.error("stores.preloading is deprecated; use stores.navigating instead"),{subscribe:t.navigating.subscribe}},session:t.session,updated:t.updated}},pe={subscribe(t){return ve().page.subscribe(t)}};S.disable_scroll_handling;const ye=S.goto;S.invalidate;S.prefetch;S.prefetch_routes;S.before_navigate;S.after_navigate;var N,Te=new Uint8Array(16);function Re(){if(!N&&(N=typeof crypto!="undefined"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto!="undefined"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!N))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return N(Te)}var we=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function Ee(t){return typeof t=="string"&&we.test(t)}var v=[];for(var L=0;L<256;++L)v.push((L+256).toString(16).substr(1));function Ve(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,o=(v[t[e+0]]+v[t[e+1]]+v[t[e+2]]+v[t[e+3]]+"-"+v[t[e+4]]+v[t[e+5]]+"-"+v[t[e+6]]+v[t[e+7]]+"-"+v[t[e+8]]+v[t[e+9]]+"-"+v[t[e+10]]+v[t[e+11]]+v[t[e+12]]+v[t[e+13]]+v[t[e+14]]+v[t[e+15]]).toLowerCase();if(!Ee(o))throw TypeError("Stringified UUID is invalid");return o}function fe(t,e,o){t=t||{};var s=t.random||(t.rng||Re)();if(s[6]=s[6]&15|64,s[8]=s[8]&63|128,e){o=o||0;for(var a=0;a<16;++a)e[o+a]=s[a];return e}return Ve(s)}function oe(t,e,o){const s=t.slice();return s[8]=e[o][0],s[9]=e[o][1],s}function le(t){let e=t[9].User+"",o,s,a=t[9].Message+"",n,u,m;return{c(){o=C(e),s=C(": "),n=C(a),u=V(),m=y("br")},l(i){o=I(i,e),s=I(i,": "),n=I(i,a),u=M(i),m=T(i,"BR",{})},m(i,c){E(i,o,c),E(i,s,c),E(i,n,c),E(i,u,c),E(i,m,c)},p(i,c){c&1&&e!==(e=i[9].User+"")&&A(o,e),c&1&&a!==(a=i[9].Message+"")&&A(n,a)},d(i){i&&_(o),i&&_(s),i&&_(n),i&&_(u),i&&_(m)}}}function Me(t){let e,o,s,a,n,u,m,i,c=t[2](t[0]),l=[];for(let r=0;r<c.length;r+=1)l[r]=le(oe(t,c,r));return{c(){e=y("div");for(let r=0;r<l.length;r+=1)l[r].c();o=V(),s=y("input"),a=V(),n=y("button"),u=C("Send Message"),this.h()},l(r){e=T(r,"DIV",{class:!0});var f=x(e);for(let U=0;U<l.length;U+=1)l[U].l(f);o=M(f),s=T(f,"INPUT",{class:!0,type:!0,placeholder:!0}),a=M(f),n=T(f,"BUTTON",{class:!0});var d=x(n);u=I(d,"Send Message"),d.forEach(_),f.forEach(_),this.h()},h(){R(s,"class","input"),R(s,"type","text"),R(s,"placeholder","Type a message..."),R(n,"class","button"),R(e,"class","box svelte-1tez4ab")},m(r,f){E(r,e,f);for(let d=0;d<l.length;d+=1)l[d].m(e,null);h(e,o),h(e,s),B(s,t[1]),h(e,a),h(e,n),h(n,u),m||(i=[H(s,"input",t[7]),H(n,"click",t[3])],m=!0)},p(r,[f]){if(f&5){c=r[2](r[0]);let d;for(d=0;d<c.length;d+=1){const U=oe(r,c,d);l[d]?l[d].p(U,f):(l[d]=le(U),l[d].c(),l[d].m(e,o))}for(;d<l.length;d+=1)l[d].d(1);l.length=c.length}f&2&&s.value!==r[1]&&B(s,r[1])},i:z,o:z,d(r){r&&_(e),X(l,r),m=!1,ce(i)}}}function Ue(t,e,o){let{messages:s={}}=e,{db:a}=e,{roomid:n}=e,{username:u="eduard faus"}=e,m="";function i(){return Object.entries(s).sort(([,f],[,d])=>f.Time-d.Time)}function c(){m!=""&&F(O(a,"Rooms/"+n+"/Messages/"+fe()),{User:u,Message:m,Time:Date.now()})}function l(){m=this.value,o(1,m)}return t.$$set=r=>{"messages"in r&&o(0,s=r.messages),"db"in r&&o(4,a=r.db),"roomid"in r&&o(5,n=r.roomid),"username"in r&&o(6,u=r.username)},[s,m,i,c,a,n,u,l]}class xe extends q{constructor(e){super(),J(this,e,Ue,Me,Q,{messages:0,db:4,roomid:5,username:6})}}function ae(t,e,o){const s=t.slice();return s[7]=e[o][0],s[8]=e[o][1],s}function re(t,e,o){const s=t.slice();return s[11]=e[o][0],s[12]=e[o][1],s}function ie(t){let e=t[12].text+"",o,s,a;return{c(){o=C(e),s=V(),a=y("br")},l(n){o=I(n,e),s=M(n),a=T(n,"BR",{})},m(n,u){E(n,o,u),E(n,s,u),E(n,a,u)},p(n,u){u&1&&e!==(e=n[12].text+"")&&A(o,e)},d(n){n&&_(o),n&&_(s),n&&_(a)}}}function ue(t){let e,o,s=t[7]+"",a,n,u,m,i=Object.entries(t[8]),c=[];for(let l=0;l<i.length;l+=1)c[l]=ie(re(t,i,l));return{c(){e=y("div"),o=y("h1"),a=C(s),n=V(),u=y("hr"),m=V();for(let l=0;l<c.length;l+=1)c[l].c();this.h()},l(l){e=T(l,"DIV",{class:!0});var r=x(e);o=T(r,"H1",{class:!0});var f=x(o);a=I(f,s),f.forEach(_),n=M(r),u=T(r,"HR",{}),m=M(r);for(let d=0;d<c.length;d+=1)c[d].l(r);r.forEach(_),this.h()},h(){R(o,"class","title"),R(e,"class","column")},m(l,r){E(l,e,r),h(e,o),h(o,a),h(e,n),h(e,u),h(e,m);for(let f=0;f<c.length;f+=1)c[f].m(e,null)},p(l,r){if(r&1&&s!==(s=l[7]+"")&&A(a,s),r&1){i=Object.entries(l[8]);let f;for(f=0;f<i.length;f+=1){const d=re(l,i,f);c[f]?c[f].p(d,r):(c[f]=ie(d),c[f].c(),c[f].m(e,null))}for(;f<c.length;f+=1)c[f].d(1);c.length=i.length}},d(l){l&&_(e),X(c,l)}}}function Ce(t){let e,o,s,a,n,u,m,i,c,l,r,f,d,U,G,K,D=Object.entries(t[0]),p=[];for(let b=0;b<D.length;b+=1)p[b]=ue(ae(t,D,b));return{c(){e=y("div"),o=y("div");for(let b=0;b<p.length;b+=1)p[b].c();s=V(),a=y("div"),n=y("h1"),u=C("Ashh"),m=V(),i=y("hr"),c=C(`
        random todo`),l=V(),r=y("input"),f=V(),d=y("button"),U=C("Add"),this.h()},l(b){e=T(b,"DIV",{class:!0});var w=x(e);o=T(w,"DIV",{class:!0});var g=x(o);for(let P=0;P<p.length;P+=1)p[P].l(g);s=M(g),a=T(g,"DIV",{class:!0});var k=x(a);n=T(k,"H1",{class:!0});var W=x(n);u=I(W,"Ashh"),W.forEach(_),m=M(k),i=T(k,"HR",{}),c=I(k,`
        random todo`),k.forEach(_),g.forEach(_),l=M(w),r=T(w,"INPUT",{class:!0,placeholder:!0}),f=M(w),d=T(w,"BUTTON",{class:!0});var Y=x(d);U=I(Y,"Add"),Y.forEach(_),w.forEach(_),this.h()},h(){R(n,"class","title"),R(a,"class","column"),R(o,"class","columns is-multiline is-mobile"),R(r,"class","input"),R(r,"placeholder","Todo Text"),R(d,"class","button"),R(e,"class","box has-text-centered")},m(b,w){E(b,e,w),h(e,o);for(let g=0;g<p.length;g+=1)p[g].m(o,null);h(o,s),h(o,a),h(a,n),h(n,u),h(a,m),h(a,i),h(a,c),h(e,l),h(e,r),B(r,t[1]),h(e,f),h(e,d),h(d,U),G||(K=[H(r,"input",t[6]),H(d,"click",t[2])],G=!0)},p(b,[w]){if(w&1){D=Object.entries(b[0]);let g;for(g=0;g<D.length;g+=1){const k=ae(b,D,g);p[g]?p[g].p(k,w):(p[g]=ue(k),p[g].c(),p[g].m(o,s))}for(;g<p.length;g+=1)p[g].d(1);p.length=D.length}w&2&&r.value!==b[1]&&B(r,b[1])},i:z,o:z,d(b){b&&_(e),X(p,b),G=!1,ce(K)}}}function Ie(t,e,o){let{todos:s={}}=e,{db:a}=e,{roomid:n}=e,{username:u="eduard faus"}=e,m="";function i(){if(m=="")return;let l={};u in s&&(l=s[u]),l[fe()]={text:m,done:!1},F(O(a,"Rooms/"+n+"/Todos/"+u),l)}console.log(s);function c(){m=this.value,o(1,m)}return t.$$set=l=>{"todos"in l&&o(0,s=l.todos),"db"in l&&o(3,a=l.db),"roomid"in l&&o(4,n=l.roomid),"username"in l&&o(5,u=l.username)},[s,m,i,a,n,u,c]}class ke extends q{constructor(e){super(),J(this,e,Ie,Ce,Q,{todos:0,db:3,roomid:4,username:5})}}function Se(t){let e,o,s,a;return e=new xe({props:{messages:t[0],db:j,roomid:t[2]}}),s=new ke({props:{todos:t[1],db:j,roomid:t[2]}}),{c(){Z(e.$$.fragment),o=V(),Z(s.$$.fragment)},l(n){$(e.$$.fragment,n),o=M(n),$(s.$$.fragment,n)},m(n,u){ee(e,n,u),E(n,o,u),ee(s,n,u),a=!0},p(n,[u]){const m={};u&1&&(m.messages=n[0]),e.$set(m);const i={};u&2&&(i.todos=n[1]),s.$set(i)},i(n){a||(te(e.$$.fragment,n),te(s.$$.fragment,n),a=!0)},o(n){se(e.$$.fragment,n),se(s.$$.fragment,n),a=!1},d(n){ne(e,n),n&&_(o),ne(s,n)}}}function De(t,e,o){let s;me(t,pe,i=>o(4,s=i));let a=s.url.toString().split("/").pop();he(async()=>{isNaN(a)||a.length!=8?ye("/room/invalidId"):ge(_e(O(j),`Rooms/${a}`)).then(i=>{i.exists()||F(O(j,"Rooms/"+a),{GlobalTimer:0,Todos:{ignor:""},Messages:{ignor:""}})}).catch(i=>{console.error(i)})});let n={},u={};const m=O(j,"Rooms/"+a);return be(m,async function(i){i.exists()&&(console.log(await i.val()),o(0,n=await i.val().Messages),delete n.ignor,o(1,u=await i.val().Todos),delete u.ignor,await i.val().GlobalTimer)}),[n,u,a]}class Ae extends q{constructor(e){super(),J(this,e,De,Se,Q,{})}}export{Ae as default};
